<!--
  ~ The contents of this file are subject to the OpenMRS Public License
  ~ Version 1.0 (the "License"); you may not use this file except in
  ~ compliance with the License. You may obtain a copy of the License at
  ~ http://license.openmrs.org
  ~
  ~ Software distributed under the License is distributed on an "AS IS"
  ~ basis, WITHOUT WARRANTY OF ANY KIND, either express or implied. See the
  ~ License for the specific language governing rights and limitations
  ~ under the License.
  ~
  ~ Copyright (C) OpenMRS, LLC.  All Rights Reserved.
-->
<htmlform>
    <macros>
        <macro key="countyNames" value="Migori,Kisumu,Homabay,Siaya,Busia" />
        <macro key="subCountyList" value="Nyatike,Uriri,Suna East,Suna West,Awendo,Rongo"/>
        <macro key="wardList" value="North Kadem, Got Kachola,Kachieng,Kaler,Macalder_Kanyarwanda,Kanyasa,Muhuru"/>
    </macros>

    <script type="text/javascript" src="../moduleResources/kenyaemr/scripts/moment.js"></script>
    <script type="text/javascript" src="../moduleResources/kenyaemr/scripts/KenyaAddressHierarchy.js"></script>
    <style>
        .simple-table {
            border: solid 1px #DDEEEE;
            border-collapse: collapse;
            border-spacing: 0;
            font: normal 13px Arial, sans-serif;
        }

        .simple-table thead th {
            background-color: #DDEFEF;
            border: solid 1px #DDEEEE;
            color: #336B6B;
            padding: 10px;
            text-align: left;
            text-shadow: 1px 1px 1px #fff;
        }

        .simple-table td {
            border: solid 1px #DDEEEE;
            color: #333;
            padding: 10px;
            text-shadow: 1px 1px 1px #fff;
        }
        .ke-error-label{
            color: red;
        }
        .ke-success-label{
            color: green;
        }
    </style>
    <script type="text/javascript">
        $(document).ready(function () {
            //Defaults
            jq("#transfer-date").hide();
            jq("#transfer-facility").hide();
            jq("#transfer-enrolment-date").hide();
            jq("#program_name").hide();
            jq("#other-hotspots-specify").hide();
            
            
            //Referred by selected
            jq("#transfer-in-status :input[type=radio]").change(onSelectedPatientType);
            jq("#peer-educator :input[type=radio]").change(onSelectedPeerEduYes);
            jq("#hotspot-type select").change(onSelectHotSpotType); 
          });

          var onSelectedPatientType = function () {
            var val = jq(this).val();
            if (val == 160563 ){
                jq("#transfer-date").show();
                jq("#transfer-facility").show();
                jq("#transfer-enrolment-date").show();
            }else {
                jq("#transfer-date").hide();
                clearHiddenSections(jq("#transfer-date"));

                jq("#transfer-facility").hide();
                clearHiddenSections(jq("#transfer-facility"));

                jq("#transfer-enrolment-date").hide();
                clearHiddenSections(jq("#transfer-enrolment-date"));
              
            }
        };

        var onSelectedPeerEduYes = function () {
            var val = jq(this).val();
            if (val == 1065 ){
                jq("#program_name").show();
            }else {
                jq("#program_name").hide();
                clearHiddenSections(jq("#program_name"));
              
            }
        };

        var onSelectHotSpotType = function () {
            var val = jq(this).val();
            if (val == 5622 ){
                jq("#other-hotspots-specify").show();
            }else {
                jq("#other-hotspots-specify").hide();
                clearHiddenSections(jq("#other-hotspots-specify"));
              
            }
        };
          
           //Clear hidden sections
    clearHiddenSections = function(parentObj) {
        parentObj.find('input[type=radio]').each(function() {
            this.checked = false;
        });
        parentObj.find('input[type=checkbox]').each(function() {
            this.checked = false;
        });
        parentObj.find('input[type=text]').each(function() {
            jq(this).val("");
        });
        parentObj.find('select').each(function() {
            this.selectedIndex =0;
        });
    }

    </script>

    <ifMode mode="EDIT">
        <script type="text/javascript">
           $(document).ready(function () {
                //Defaults
                jq("#transfer-date").hide();
                jq("#transfer-facility").hide();
                jq("#transfer-enrolment-date").hide();
                jq("#program_name").hide();
                jq("#other-hotspots-specify").hide();
                
                //Referred by selected
                jq("#transfer-in-status :input[type=radio]").change(onSelectedPatientType);
                jq("#peer-educator :input[type=radio]").change(onSelectedPeerEduYes);
                jq("#hotspot-type select").change(onSelectHotSpotType); 
              });
    
              var onSelectedPatientType = function () {
                var val = jq(this).val();
                if (val == 160563 ){
                    jq("#transfer-date").show();
                    jq("#transfer-facility").show();
                    jq("#transfer-enrolment-date").show();
                }else {
                    jq("#transfer-date").hide();
                    clearHiddenSections(jq("#transfer-date"));

                    jq("#transfer-facility").hide();
                    clearHiddenSections(jq("#transfer-facility"));

                    jq("#transfer-enrolment-date").hide();
                    clearHiddenSections(jq("#transfer-enrolment-date"));
                  
                }
            };

            var onSelectedPeerEduYes = function () {
                var val = jq(this).val();
                if (val == 1065 ){
                    jq("#program_name").show();
                }else {
                    jq("#program_name").hide();
                    clearHiddenSections(jq("#program_name"));
                  
                }
            };

            var onSelectHotSpotType = function () {
                var val = jq(this).val();
                if (val == 5622 ){
                    jq("#other-hotspots-specify").hide();
                }else {
                    jq("#other-hotspots-specify").hide();
                    clearHiddenSections(jq("#other-hotspots-specify"));
                  
                }
            };
               //Clear hidden sections
        clearHiddenSections = function(parentObj) {
            parentObj.find('input[type=radio]').each(function() {
                this.checked = false;
            });
            parentObj.find('input[type=checkbox]').each(function() {
                this.checked = false;
            });
            parentObj.find('input[type=text]').each(function() {
                jq(this).val("");
            });
            parentObj.find('select').each(function() {
                this.selectedIndex =0;
            });
        }
        </script>
    </ifMode>
    <div class="ke-form-header">
        <table width="100%">
            <tr>
                <td align="left">Date of first contact:
                    <encounterDate id="encounter-date" showTime="true"/>
                </td>
                <td align="right">Location:
                    <encounterLocation default="GlobalProperty:kenyaemr.defaultLocation" type="autocomplete"/>
                </td>
            </tr>
        </table>
    </div>

    <div class="ke-form-content">
        <fieldset>
            <legend>Contact Form</legend>
            <table class="simple-table">
                <tr>
                    <td>Patient Type</td>
                    <td colspan="3">
                        <obs
                                id="transfer-in-status" conceptId="164932" style="radio"
                                answerConceptIds="164144,160563"
                                answerLabels="New Patient,Transfer in"
                                required="true"
                                />
                        
                    </td>
                </tr>
                 <tr id="transfer-date">
                            <td>Transfer in date:</td>
                            <td colspan="3"><obs conceptId="160534AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="transfer-in-date" allowFutureDates="false"/></td>
                                
                  </tr>
                  <tr id="transfer-facility">
                            <td>Name of transferred from site:</td>
                            <td colspan="3"><obs conceptId="160535AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"  size="20" id="transfer-facility"/></td>
                                
                    </tr>
                   <tr id="transfer-enrolment-date">
                       <td>Date <i>first</i> enrolled in FFx program:</td>
                        <td colspan="3"><obs conceptId="160555AAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" id="first-enrolled-date" allowFutureDates="false"/></td>
                            
                </tr>
                <tr id="tr-key-pop" >
                    <td>Fisherfolk Population Type</td>
                    <td colspan="3">
                        <obs id="key_pop_type" conceptId="164929"
                        answerConceptIds="165083,160578,165084,105,165085,165100,162277,159674"
                        answerLabels="Fishers,Fish Mongers,Fish Traders,Boat Owners,Fish Processors,Beach Hoteliers,Beach Boys and Girls,Fishing Net Makers,Boat Owners"
                        style="radio"
                        required="true" />
                    </td>
                </tr>
                <tr>
                    <td>
                        Implementation
                    </td>
                    <td align="left" width="15%">
                        County: <obs required="true" id="implementation-county" conceptId="CIEL:167131"  answers="$countyNames" answerLabels="$countyNames"/>

                    </td>
                    <td align="left" width="15%">
                        Sub County: <obs id="implementation-subCounty" required="true" conceptId="CIEL:161551" answers="$subCountyList" answerLabels="$subCountyList"/>
                    </td>
                    <td align="left" width="20%">
                        Ward: <obs id="implementation-ward" required="true" conceptId="CIEL:161550" answers="$wardList" answerLabels="$wardList"/>
                    </td>
                </tr>
                <tr>
                    <td>Unique Identifier code</td>
                    <td>
                        <span id="kp-id"><patient id="upn" field="identifier" identifierTypeId="b7bfefd0-239b-11e9-ab14-d663bd873d93" 
                            required="true" /></span>
                    </td>
                    <td>Alias:</td>
                    <td>
                        <span id="alias-success-label"><label style="color: green" id="lblClientAliasCompletionState"/></span>
                        <input type="text" name="kpalias" id="kpalias" />
                        <button   class="saveAlias">Save Alias</button>

                    </td>
                </tr>
                <tr>
                    <td>Alternative Contact Person</td>
                    <td>
                        Name :
                        <obs id="altname" conceptId="160638"/>
                    </td>
                    <td>
                        Telephone number :
                    </td>
                    <td>
                        <obs id="mobile" conceptId="160642"/>
                    </td>
                </tr>
                <tr>
                    <td >Have you been contacted by a peer educator?</td>
                    <td colspan="3">
                        <obs id="peer-educator" conceptId="165004"
                             answerConceptIds="1065AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,1066AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                             answerLabels="Yes,No"
                             style="radio" required="true" />
                    </td>

                </tr>
                <tr id="program_name">

                    <td width="400" valign="top">If yes, which programme do you receive service from?</td>
                    <td colspan="3">
                        <obs id="program" conceptId="165137"/>

                    </td>
                </tr>
                <tr>
                    <td >Hotspot/Beach mostly frequented</td>
                    <td >
                        <obs conceptId="165006" required="true" id="hotspot_frequented"/>  
                    </td>
                    <td >Type of Hotspot</td>
                    <td >
                        <obs conceptId="165005"
                             answerConceptIds="165011,
                                                   165012,
                                                   165013,
                                                   165014,
                                                   1536AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA,
                                                   165015,
                                                   165016,
                                                   165017,
                                                   165018,
                                                   165019,
                                                   165020,
                                                   165021,
                                                   165022,
                                                   165023,
                                                   165024,
                                                   165025,
                                                   165026,
                                                   165297,
                                                   167082,
                                                   5622AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"
                             answerLabels="Street,
                                              Injecting den,
                                              Uninhabitable building,
                                              Park,
                                              Homes,
                                              Beach,
                                              Casino,
                                              Bar with lodging,
                                              Bar without lodging,
                                              Sex den,
                                              Strip club,
                                              Highways,
                                              Brothel,
                                              Guest house/Hotels/Lodgings,
                                              Massage parlor,
                                              Chang&apos;aa den,
                                              Barbershop/Salon,
                                              Virtual Space,
                                              Landing Site,
                                              Other (Specify)"
                             id="hotspot-type"
                             style="dropdown" />
                        <br/><br/>
                        <obs conceptId="165298" id="other-hotspots-specify"/>
                        <br />
                    </td>
                </tr>

                <tr>
                    <td width="550" valign="top">On average, how many sex acts do you have per week</td>
                    <td width="550" valign="top">
                        <obs id="sex_act" conceptId="165007"/>

                    </td>
                </tr>
            </table>
        </fieldset>
        <enrollInProgram programId="7447305a-18a7-11e9-ab14-d663bd873d93"/>
    </div>

    <div class="ke-form-footer">
        <submit/>
    </div>

</htmlform>
